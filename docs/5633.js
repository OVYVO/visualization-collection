(self.webpackChunkvisualization_collection=self.webpackChunkvisualization_collection||[]).push([[5633],{65633:t=>{self,t.exports=function(){"use strict";var t,i={};!function(t){t[t.waitStart=0]="waitStart",t[t.inAnimation=1]="inAnimation",t[t.stop=2]="stop"}(t||(t={}));var o=function(){function i(i,o,s,r){this.ctx=i||null,this.canvas=o||null,this.options={collisionRectX:0,collisionRectY:0,collisionRectWidth:o.width,collisionRectHeight:o.height,monitorMousePos:!1,beforeDrawGlobules:null,afterDrawGlobules:null,onMouseDownCanvas:null,onMouseMoveCanvas:null,onMouseUpCanvas:null,onMouseLeaveCanvas:null},r&&(this.options=Object.assign({},this.options,r)),this.frameId=0,this.animationState=t.waitStart,this.mousePos={mouseX:null,mouseY:null},this.prevMousePos={mouseX:null,mouseY:null},this.isMouseDown=!1,this.mouseDownPos={mouseX:null,mouseY:null};var h=[];if(s&&s.length>0)for(var n=0,u=s.length;n<u;n++){var l=s[n],a=new e(i,o,l,this.mousePos);h.push(a)}if(this.globuleList=h,this.options.monitorMousePos){var c=this;o.addEventListener("mousedown",(function(t){c._updateMouseProperty(t),c.mouseInGlobuleList.forEach((function(t){var i=t.requiredMouseInteraction,o=t.mouseInteractionBehavior;i&&"drag"===o&&(t.vx=0,t.vy=0)})),c.options.onMouseDownCanvas&&c.options.onMouseDownCanvas(t,c)})),o.addEventListener("mousemove",(function(t){c._updateMouseProperty(t),c.isMouseDown&&c.mouseInGlobuleList.forEach((function(t){var i=t.requiredMouseInteraction,o=t.mouseInteractionBehavior;if(i&&"drag"===o){var e=c.mousePos.mouseX-c.prevMousePos.mouseX,s=c.mousePos.mouseY-c.prevMousePos.mouseY;t.x+=e,t.y+=s;var r=t.receiveOutForce,h=t.maxMouseOutForce;if(r){var n=e,u=s;if(h){var l=t.getXAndYValue(h,e,s),a=l.x,v=l.y;n>a?n=a:n<-a&&(n=-a),u>v?u=v:u<-v&&(u=-v)}t.vx=n,t.vy=u}}})),c.options.onMouseMoveCanvas&&c.options.onMouseMoveCanvas(t,c)})),o.addEventListener("mouseup",(function(t){c._updateMouseProperty(t),c.options.onMouseUpCanvas&&c.options.onMouseUpCanvas(t,c)})),o.addEventListener("mouseleave",(function(t){c._updateMouseProperty(t),c.options.onMouseLeaveCanvas&&c.options.onMouseLeaveCanvas(t,c)}))}}return i.prototype.start=function(){var i=this;this.animationState=t.inAnimation,i.frameId=requestAnimationFrame((function o(){if(i.animationState===t.inAnimation){var e=i.ctx,s=i.canvas,r=i.globuleList,h=i.options,n=h.beforeDrawGlobules,u=h.afterDrawGlobules,l=h.collisionRectX,a=h.collisionRectY,c=h.collisionRectWidth,v=h.collisionRectHeight,f=s.width,y=s.height;n?n&&n(i):e.clearRect(0,0,f,y),r.forEach((function(t,i){t._drawCurrentFrame(r,i,l,a,c,v)})),u&&u(i),r.forEach((function(t){t.inCollisionGlobule=!1,t.inCollisionGlobuleList=[],t.inCollisionWall=!1})),r.forEach((function(t,i){t._calculateNextFrame(r,i,l,a,c,v)})),i.frameId=requestAnimationFrame(o)}}))},i.prototype.createGlobule=function(t){return new e(this.ctx,this.canvas,t,this.mousePos)},i.prototype.updateGlobuleList=function(t){"[object Array]"===Object.prototype.toString.call(t)&&(this.globuleList=t)},i.prototype.stop=function(){this.animationState===t.inAnimation&&(this.animationState=t.stop),this.frameId&&(cancelAnimationFrame(this.frameId),this.frameId=0)},i.prototype._updateMouseProperty=function(t){if(this.prevMousePos.mouseX=this.mousePos.mouseX,this.prevMousePos.mouseY=this.mousePos.mouseY,"mouseLeave"===t.type)this.mousePos.mouseX=null,this.mousePos.mouseY=null;else{var i=this.canvas.getBoundingClientRect(),o=t.clientX-i.left,e=t.clientY-i.top;this.mousePos.mouseX=o,this.mousePos.mouseY=e}switch(this.mouseInGlobuleList=this._getMouseInGlobuleList(t.type),t.type){case"mousedown":this.isMouseDown=!0,this.mouseDownPos.mouseX=this.mousePos.mouseX,this.mouseDownPos.mouseY=this.mousePos.mouseY,this.mouseInGlobuleList.forEach((function(t){t.controlledByMouse=!0}));break;case"mousemove":default:break;case"mouseup":case"mouseleave":this.isMouseDown=!1,this.mouseDownPos.mouseX=null,this.mouseDownPos.mouseY=null}},i.prototype._getMouseInGlobuleList=function(t){var i=[],o=this;return this.globuleList.forEach((function(e){"mousemove"===t&&"drag"===e.mouseInteractionBehavior&&e.controlledByMouse?i.push(e):(e.controlledByMouse=!1,o._checkMouseInGlobule(e)&&i.push(e))})),i},i.prototype._checkMouseInGlobule=function(t){var i=this.mousePos,o=i.mouseX,e=i.mouseY,s=!1;return null!==o&&null!==e&&Math.hypot(o-t.x,e-t.y)<t.radius&&(s=!0),s},i}(),e=function(){function t(t,i,o,e){var s=o.id,r=o.initX,h=o.initY,n=o.vx,u=o.vy,l=o.radius,a=o.color,c=o.isPureColor,v=o.alpha,f=o.alphaChangeV,y=o.bgImg,d=o.collisionLossV,p=o.moveLossV,m=o.gDirection,x=o.gCoefficient,M=o.requiredMouseInteraction,b=o.mouseInteractionBehavior,F=o.fixedPos,g=o.receiveOutForce,C=o.receiveWallForce,V=o.resistanceWallDirection,P=o.onlyCheckCollision,X=o.perfectlyElasticCollision,Y=o.maxMouseOutForce,w=o.maxMoveV,_=o.beforeDrawGlobule,L=o.afterDrawGlobule,O=o.afterCalculateNextFrameGlobule;this.id=s,this.ctx=t,this.canvas=i,this.initX=r||0,this.initY=h||0,this.x=this.initX,this.y=this.initY,this.previousX=null,this.previousY=null,this.vx=n||0,this.vy=u||0,this.radius=l||10,this.color=a||"#666666",this.isPureColor=!!c,this.alpha="number"==typeof v?v<0?0:v>1?1:v:1,this.alphaChangeV="number"==typeof f?f:0,this.bgImg=y||"",this.collisionLossV=d||0,this.moveLossV=p||0,this.gDirection=m,this.gCoefficient=x||0,this.requiredMouseInteraction=!!M,this.mouseInteractionBehavior=b||(this.requiredMouseInteraction?"over":void 0),this.fixedPos=!!F,this.receiveOutForce="boolean"!=typeof g||g,this.receiveWallForce="boolean"!=typeof C||C,this.resistanceWallDirection=V&&V.length>1?V:["bottom","top","left","right"],this.onlyCheckCollision=!!P,this.perfectlyElasticCollision=!!X,this.maxMouseOutForce=Y||null,this.mousePos=e||{mouseX:null,mouseY:null},this.maxMoveV=w||null,this.controlledByMouse=!1,this.firstHoverX=null,this.firstHoverY=null,this.outForceLastTime=null,this.inCollisionGlobule=!1,this.inCollisionGlobuleList=[],this.inCollisionWall=!1,this.beforeDrawGlobule=_||null,this.afterDrawGlobule=L||null,this.afterCalculateNextFrameGlobule=O||null}return t.prototype._draw=function(){if(this.ctx.save(),this.ctx.beginPath(),this.color)if(this.isPureColor)this.ctx.fillStyle=this.color;else{var t=this.ctx.createRadialGradient(this.x,this.y,0,this.x,this.y,this.radius);t.addColorStop(0,"#ffffff"),t.addColorStop(1,this.color),this.ctx.fillStyle=t}if(this.ctx.globalAlpha=this.alpha,this.ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),this.ctx.fill(),this.bgImg){var i=new Image;i.width=2*this.radius,i.height=2*this.radius,i.src=this.bgImg,this.ctx.drawImage(i,this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}this.ctx.restore(),this.previousX=this.x,this.previousY=this.y},t.prototype._drawCurrentFrame=function(t,i,o,e,s,r){if(this.receiveOutForce)for(var h=i+1,n=t.length;h<n;h++){var u=t[h];this._checkOverlap(u)}this._checkOverWall(o,e,s,r),null!==this.previousX&&null!==this.previousY&&this.previousX===this.x&&this.previousY===this.y&&(0!==this.vx&&(this.vx=0),0!==this.vy&&(this.vy=0)),this.beforeDrawGlobule&&this.beforeDrawGlobule(this),this._draw(),this.afterDrawGlobule&&this.afterDrawGlobule(this)},t.prototype._calculateNextFrame=function(t,i,o,e,s,r){this._checkHover();for(var h=i+1,n=t.length;h<n;h++){var u=t[h];this._checkCollisionGlobule(u)}if(this._checkCollisionWall(o,e,s,r),this._addGravitation(),this.controlledByMouse||(this.x+=this.vx,this.y+=this.vy),0!==this.alphaChangeV){var l=this.alpha+this.alphaChangeV;l<0?l=0:l>1&&(l=1),this.alpha=l}this._addMoveLoss(),this.afterCalculateNextFrameGlobule&&this.afterCalculateNextFrameGlobule(this)},t.prototype._getOutForce=function(t,i,o,e,s,r,h){var n=this,u=n.x,l=n.y,a=n.vx,c=n.vy;if(this.perfectlyElasticCollision||h)return this._getPerfectlyElasticOutForce(t,i,o,e);var v=0,f=0;if(0===a&&0===c){var y=this._getCosspoint(t+o,i+e,t,i,u,l);v=((p=y.x)-t)/2,f=((m=y.y)-i)/2}else if(0===o&&0===e){var d=this._getCosspoint(u+a,l+c,u,l,t,i),p=d.x,m=d.y;s||r?(v=2*-(p-u),f=2*-(m-l)):(v=3*-(p-u)/2,f=3*-(m-l)/2)}else{var x=this._getLineEquation(u,-l,t,-i);if(x){var M=this._getLineEquation(u,-l,u+a,-(l+c));if(M&&M.k===x.k&&M.b===x.b){var b=this._getLineEquation(t,-i,t+o,-(i+e));if(b){if(b.k===x.k&&b.b===x.b){if(a*o<=0&&c*e<=0)return{outForceVX:-a+o,outForceVY:-c+e}}else if(M.k===-1/b.k)return(t-u>0&&a>0||t-u<0&&a<0)&&(i-l>0&&c>0||i-l<0&&c<0)?{outForceVX:-a+o,outForceVY:-c+e}:{outForceVX:0,outForceVY:0}}else if(0===M.k)return u>t&&a<0||u<t&&a>0?{outForceVX:2*-a,outForceVY:0}:{outForceVX:0,outForceVY:0}}}else{if(0===a&&0===o)return{outForceVX:0,outForceVY:-c+e};if(0===a&&c>0&&0===e)return l<i?{outForceVX:0,outForceVY:2*-c}:{outForceVX:0,outForceVY:0};if(0===a&&c<0&&0===e)return l>i?{outForceVX:0,outForceVY:2*-c}:{outForceVX:0,outForceVY:0}}var F=this._getCosspoint(t+o,i+e,t,i,u,l);((v=(p=F.x)-t)>0&&a>0||v<0&&a<0)&&(v-=a),((f=(m=F.y)-i)>0&&c>0||f<0&&c<0)&&(f-=c)}return{outForceVX:v,outForceVY:f}},t.prototype._getPerfectlyElasticOutForce=function(t,i,o,e){var s=this,r=s.x,h=s.y,n=s.vx,u=s.vy,l=Math.hypot(n,u),a=this._getAngleTypeBetweenTwoVectors(n,u,t-r,i-h);if(a&&a>0){var c=this.getXAndYValue(l,r-t,h-i);return{outForceVX:-n+c.x,outForceVY:-u+c.y}}var v=this._getAngleTypeBetweenTwoVectors(o,e,r-t,h-i);if(v&&v>0){0===l&&(l=Math.hypot(o,e));var f=this.getXAndYValue(l,r-t,h-i);return{outForceVX:-n+f.x,outForceVY:-u+f.y}}return{outForceVX:0,outForceVY:0}},t.prototype._getMouseOutForce=function(t,i){var o=t,e=i,s=this,r=s.requiredMouseInteraction,h=s.mouseInteractionBehavior,n=s.maxMouseOutForce;return r&&"over"===h&&n&&(o>n?o=n:o<-n&&(o=-n),e>n?e=n:e<-n&&(e=-n)),{outForceVX:o,outForceVY:e}},t.prototype.addOutForce=function(t,i,o){if(void 0===o&&(o=!1),!(this.fixedPos||0===t&&0===i)&&(this.vx+=t,this.vy+=i,o&&this._addCollisionLoss(),"number"==typeof this.maxMoveV&&this.maxMoveV>=0&&Math.hypot(this.vx,this.vy)>this.maxMoveV)){var e=this.getXAndYValue(this.maxMoveV,this.vx,this.vy),s=e.x,r=e.y;this.vx=s,this.vy=r}},t.prototype._checkHover=function(){if(!this.fixedPos&&this.requiredMouseInteraction&&"over"===this.mouseInteractionBehavior){var t=this.mousePos,i=t.mouseX,o=t.mouseY;if(null!==i&&null!==o&&Math.hypot(i-this.x,o-this.y)<=this.radius){if(this.outForceLastTime&&(new Date).getTime()-this.outForceLastTime<400)return;if(null!==this.firstHoverX&&null!==this.firstHoverY){var e=i-this.firstHoverX,s=o-this.firstHoverY,r=this._getMouseOutForce(e,s),h=r.outForceVX,n=r.outForceVY;this.addOutForce(h,n),this.outForceLastTime=(new Date).getTime(),this.firstHoverX=null,this.firstHoverY=null}else this.firstHoverX=i,this.firstHoverY=o}}},t.prototype._checkCollisionWall=function(t,i,o,e){if(this.receiveWallForce&&!this.fixedPos){var s=this,r=s.x,h=s.y,n=s.radius,u=s.vx,l=s.vy,a=s.resistanceWallDirection,c=0,v=0,f=!1;a.includes("bottom")&&h>=i+e-n&&l>0&&(v=2*-l,f=!0),a.includes("top")&&h<=n+i&&l<0&&(v=2*-l,f=!0),a.includes("left")&&r<=n+t&&u<0&&(c=2*-u,f=!0),a.includes("right")&&r>=t+o-n&&u>0&&(c=2*-u,f=!0),f?(this.inCollisionWall=!0,this.addOutForce(c,v,!0)):this.inCollisionWall=!1}},t.prototype._checkCollisionGlobule=function(t){var i=t.x,o=t.y,e=t.radius,s=t.vx,r=t.vy,h=t.receiveOutForce,n=t.onlyCheckCollision,u=t.fixedPos,l=t.controlledByMouse,a=t.perfectlyElasticCollision;if((this.receiveOutForce||this.onlyCheckCollision||h||n)&&Math.hypot(i-this.x,o-this.y)<=e+this.radius&&(s!==this.vx||r!==this.vy)){var c=this.x,v=this.y,f=this.vx,y=this.vy;if(this.receiveOutForce&&h||this.onlyCheckCollision){var d=this._getOutForce(i,o,s,r,u,l,a),p=d.outForceVX,m=d.outForceVY;this.receiveOutForce&&h&&!this.fixedPos&&!this.controlledByMouse&&this.addOutForce(p,m,!0),0===p&&0===m||(this.inCollisionGlobule=!0,this.inCollisionGlobuleList.push(t))}if(this.receiveOutForce&&h||n){var x=t._getOutForce(c,v,f,y,this.fixedPos,this.controlledByMouse,this.perfectlyElasticCollision),M=x.outForceVX,b=x.outForceVY;this.receiveOutForce&&h&&!u&&!l&&t.addOutForce(M,b,!0),0===M&&0===b||(t.inCollisionGlobule=!0,t.inCollisionGlobuleList.push(this))}}},t.prototype._addCollisionLoss=function(){if(this.receiveOutForce&&!this.fixedPos&&0!==this.collisionLossV&&!this.controlledByMouse){var t=this.getXAndYValue(this.collisionLossV,this.vx,this.vy),i=t.x,o=t.y;Math.abs(this.vx)>Math.abs(i)?this.vx-=i:this.vx=0,Math.abs(this.vy)>Math.abs(o)?this.vy-=o:this.vy=0}},t.prototype._addMoveLoss=function(){if(!this.fixedPos&&0!==this.moveLossV&&!this.controlledByMouse){var t=this.getXAndYValue(this.moveLossV,this.vx,this.vy),i=t.x,o=t.y;Math.abs(this.vx)>Math.abs(i)?this.vx-=i:this.vx=0,Math.abs(this.vy)>Math.abs(o)?this.vy-=o:this.vy=0}},t.prototype._checkOverlap=function(t){var i=t.x,o=t.y,e=t.radius,s=t.receiveOutForce,r=t.fixedPos,h=t.controlledByMouse;if(this.receiveOutForce&&s&&(!this.fixedPos||!r)){var n=Math.hypot(i-this.x,o-this.y);if(n+.2<e+this.radius){var u=e+this.radius-n;this.fixedPos||this.controlledByMouse||r||h||(u/=2);var l=0,a=0;this.x===i?(a=u,this.y>o?(this.fixedPos||this.controlledByMouse||(this.y=this.y+a),r||h||(t.y=o-a)):(this.fixedPos||this.controlledByMouse||(this.y=this.y-u),r||h||(t.y=o+u))):this.y===o?(l=u,this.x>i?(this.fixedPos||this.controlledByMouse||(this.x=this.x+l),r||h||(t.x=i-l)):(this.fixedPos||this.controlledByMouse||(this.x=this.x-l),r||h||(t.x=i+l))):this.x>i?(l=u/n*Math.abs(this.x-i),a=u/n*Math.abs(this.y-o),this.y>o?(this.fixedPos||this.controlledByMouse||(this.x=this.x+l,this.y=this.y+a),r||h||(t.x=i-l,t.y=o-a)):(this.fixedPos||this.controlledByMouse||(this.x=this.x+l,this.y=this.y-a),r||h||(t.x=i-l,t.y=o+a))):(l=u/n*Math.abs(this.x-i),a=u/n*Math.abs(this.y-o),this.y>o?(this.fixedPos||this.controlledByMouse||(this.x=this.x-l,this.y=this.y+a),r||h||(t.x=i+l,t.y=o-a)):(this.fixedPos||this.controlledByMouse||(this.x=this.x-l,this.y=this.y-a),r||h||(t.x=i+l,t.y=o+a)))}}},t.prototype._checkOverWall=function(t,i,o,e){if(this.receiveWallForce&&!this.fixedPos){var s=this,r=s.x,h=s.y,n=s.radius;this.resistanceWallDirection.includes("bottom")&&h>i+e-n&&(this.y=i+e-n),this.resistanceWallDirection.includes("top")&&h<n+i&&(this.y=n+i),this.resistanceWallDirection.includes("left")&&r<n+t&&(this.x=n+t),this.resistanceWallDirection.includes("right")&&this.x>t+o-n&&(this.x=t+o-n)}},t.prototype._addGravitation=function(){if(!this.fixedPos&&this.gDirection&&this.gCoefficient&&!this.controlledByMouse)switch(this.gDirection){case"toInit":var t=(this.initX-this.x)*this.gCoefficient,i=(this.initY-this.y)*this.gCoefficient;this.addOutForce(t,i);break;case"toBottom":var o=this.gCoefficient;this.addOutForce(0,o);break;case"toTop":var e=-this.gCoefficient;this.addOutForce(0,e);break;case"toLeft":var s=-this.gCoefficient;this.addOutForce(s,0);break;case"toRight":var r=this.gCoefficient;this.addOutForce(r,0)}},t.prototype.getXAndYValue=function(t,i,o){return 0===i&&0===o?{x:0,y:0}:{x:t*i/Math.hypot(i,o),y:t*o/Math.hypot(i,o)}},t.prototype._getAngleTypeBetweenTwoVectors=function(t,i,o,e){return 0===t&&0===i||0===o&&0===e?null:(t*o+i*e)/(Math.hypot(t,i)*Math.hypot(o,e))},t.prototype._getLineEquation=function(t,i,o,e){if(t===o)return null;var s=(e-i)/(o-t);return{k:s,b:i-s*t}},t.prototype._getCosspoint=function(t,i,o,e,s,r){var h=this._getLineEquation(o,-e,s,-r);if(h){var n=h.k,u=h.b;if(0===n)return{x:t,y:e};var l=-1/n,a=(u-(-i-l*t))/(l-n);return{x:a,y:-(n*a+u)}}return{x:o,y:i}},t}();return i.default=o,i.default}()}}]);